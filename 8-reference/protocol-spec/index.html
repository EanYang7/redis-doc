
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Redis serialization protocol (RESP) is the wire protocol that clients implement">
      
      
        <meta name="author" content="Ean Yang">
      
      
        <link rel="canonical" href="https://eanyang7.github.io/redis-doc/8-reference/protocol-spec/">
      
      
        <link rel="prev" href="../key-specs/">
      
      
        <link rel="next" href="../sentinel-clients/">
      
      
      <link rel="icon" href="../../assets/favicon.jpg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.12">
    
    
      
        <title>Redis serialization protocol specification - redis 文档</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="deep-purple">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#resp-versions" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="redis 文档" class="md-header__button md-logo" aria-label="redis 文档" data-md-component="logo">
      
  <img src="../../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            redis 文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Redis serialization protocol specification
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="deep-purple"  aria-label="切换为暗黑模式"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="切换为暗黑模式" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="red"  aria-label="切换为浅色模式"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="切换为浅色模式" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/EanYang7/redis-doc" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    github仓库
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="redis 文档" class="md-nav__button md-logo" aria-label="redis 文档" data-md-component="logo">
      
  <img src="../../assets/logo.jpg" alt="logo">

    </a>
    redis 文档
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EanYang7/redis-doc" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    github仓库
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../0-about/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    0 about
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../1-get-started/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    1 get started
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../2-install/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    2 install
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../3-connect/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    3 connect
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../4-data-types/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    4 data types
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../5-interact/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    5 interact
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../6-manual/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    6 manual
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../7-management/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    7 management
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    8 reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            8 reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../_index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../arm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARM support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../clients/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis client handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis cluster specification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../command-arguments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis command arguments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../command-tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis command tips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../gopher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis and the Gopher protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../key-specs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command key specifications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Redis serialization protocol specification
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Redis serialization protocol specification
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#resp-versions" class="md-nav__link">
    <span class="md-ellipsis">
      RESP versions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Network layer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-response-model" class="md-nav__link">
    <span class="md-ellipsis">
      Request-Response model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resp-protocol-description" class="md-nav__link">
    <span class="md-ellipsis">
      RESP protocol description
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RESP protocol description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Simple strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Simple errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integers" class="md-nav__link">
    <span class="md-ellipsis">
      Integers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Bulk strings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bulk strings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#null-bulk-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Null bulk strings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Arrays
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Arrays">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#null-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Null arrays
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-elements-in-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Null elements in arrays
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nulls" class="md-nav__link">
    <span class="md-ellipsis">
      Nulls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#booleans" class="md-nav__link">
    <span class="md-ellipsis">
      Booleans
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#doubles" class="md-nav__link">
    <span class="md-ellipsis">
      Doubles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#big-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Big numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Bulk errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verbatim-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Verbatim strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maps" class="md-nav__link">
    <span class="md-ellipsis">
      Maps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sets" class="md-nav__link">
    <span class="md-ellipsis">
      Sets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pushes" class="md-nav__link">
    <span class="md-ellipsis">
      Pushes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client-handshake" class="md-nav__link">
    <span class="md-ellipsis">
      Client handshake
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sending-commands-to-a-redis-server" class="md-nav__link">
    <span class="md-ellipsis">
      Sending commands to a Redis server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-commands-and-pipelining" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple commands and pipelining
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inline-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Inline commands
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-performance-parser-for-the-redis-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      High-performance parser for the Redis protocol
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tips-for-redis-client-authors" class="md-nav__link">
    <span class="md-ellipsis">
      Tips for Redis client authors
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../sentinel-clients/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sentinel client spec
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../signals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis signal handling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../eviction/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Eviction
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../internals/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Internals
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../modules/_index/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#resp-versions" class="md-nav__link">
    <span class="md-ellipsis">
      RESP versions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-layer" class="md-nav__link">
    <span class="md-ellipsis">
      Network layer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-response-model" class="md-nav__link">
    <span class="md-ellipsis">
      Request-Response model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resp-protocol-description" class="md-nav__link">
    <span class="md-ellipsis">
      RESP protocol description
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RESP protocol description">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simple-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Simple strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Simple errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integers" class="md-nav__link">
    <span class="md-ellipsis">
      Integers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Bulk strings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bulk strings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#null-bulk-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Null bulk strings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Arrays
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Arrays">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#null-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Null arrays
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#null-elements-in-arrays" class="md-nav__link">
    <span class="md-ellipsis">
      Null elements in arrays
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nulls" class="md-nav__link">
    <span class="md-ellipsis">
      Nulls
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#booleans" class="md-nav__link">
    <span class="md-ellipsis">
      Booleans
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#doubles" class="md-nav__link">
    <span class="md-ellipsis">
      Doubles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#big-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Big numbers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-errors" class="md-nav__link">
    <span class="md-ellipsis">
      Bulk errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verbatim-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Verbatim strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#maps" class="md-nav__link">
    <span class="md-ellipsis">
      Maps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sets" class="md-nav__link">
    <span class="md-ellipsis">
      Sets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pushes" class="md-nav__link">
    <span class="md-ellipsis">
      Pushes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#client-handshake" class="md-nav__link">
    <span class="md-ellipsis">
      Client handshake
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sending-commands-to-a-redis-server" class="md-nav__link">
    <span class="md-ellipsis">
      Sending commands to a Redis server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-commands-and-pipelining" class="md-nav__link">
    <span class="md-ellipsis">
      Multiple commands and pipelining
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inline-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Inline commands
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-performance-parser-for-the-redis-protocol" class="md-nav__link">
    <span class="md-ellipsis">
      High-performance parser for the Redis protocol
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tips-for-redis-client-authors" class="md-nav__link">
    <span class="md-ellipsis">
      Tips for Redis client authors
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/EanYang7/redis-doc/tree/main/docs/8-reference/protocol-spec.md" title="编辑此页" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/EanYang7/redis-doc/tree/main/docs/8-reference/protocol-spec.md" title="查看本页的源代码" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"/></svg>
    </a>
  


  <h1>Redis serialization protocol specification</h1>

<p>To communicate with the Redis server, Redis clients use a protocol called REdis Serialization Protocol (RESP).
While the protocol was designed specifically for Redis, you can use it for other client-server software projects.</p>
<p>RESP is a compromise among the following considerations:</p>
<ul>
<li>Simple to implement.</li>
<li>Fast to parse.</li>
<li>Human readable.</li>
</ul>
<p>RESP can serialize different data types including integers, strings, and arrays.
It also features an error-specific type.
A client sends a request to the Redis server as an array of strings.
The array's contents are the command and its arguments that the server should execute.
The server's reply type is command-specific.</p>
<p>RESP is binary-safe and uses prefixed length to transfer bulk data so it does not require processing bulk data transferred from one process to another.</p>
<p>RESP is the protocol you should implement in your Redis client.</p>
<p>{{% alert title="Note" color="info" %}}
The protocol outlined here is used only for client-server communication.
<a href="/docs/reference/cluster-spec">Redis Cluster</a> uses a different binary protocol for exchanging messages between nodes.
{{% /alert %}}</p>
<h2 id="resp-versions">RESP versions<a class="headerlink" href="#resp-versions" title="Permanent link">⚓︎</a></h2>
<p>Support for the first version of the RESP protocol was introduced in Redis 1.2.
Using RESP with Redis 1.2 was optional and had mainly served the purpose of working the kinks out of the protocol.</p>
<p>In Redis 2.0, the protocol's next version, a.k.a RESP2, became the standard communication method for clients with the Redis server.</p>
<p><a href="https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md">RESP3</a> is a superset of RESP2 that mainly aims to make a client author's life a little bit easier.
Redis 6.0 introduced experimental opt-in support of RESP3's features (excluding streaming strings and streaming aggregates).
In addition, the introduction of the <code>HELLO</code> command allows clients to handshake and upgrade the connection's protocol version (see <a href="#client-handshake">Client handshake</a>).</p>
<p>Up to and including Redis 7, both RESP2 and RESP3 clients can invoke all core commands.
However, commands may return differently typed replies for different protocol versions.</p>
<p>Future versions of Redis may change the default protocol version, but it is unlikely that RESP2 will become entirely deprecated.
It is possible, however, that new features in upcoming versions will require the use of RESP3.</p>
<h2 id="network-layer">Network layer<a class="headerlink" href="#network-layer" title="Permanent link">⚓︎</a></h2>
<p>A client connects to a Redis server by creating a TCP connection to its port (the default is 6379).</p>
<p>While RESP is technically non-TCP specific, the protocol is used exclusively with TCP connections (or equivalent stream-oriented connections like Unix sockets) in the context of Redis.</p>
<h2 id="request-response-model">Request-Response model<a class="headerlink" href="#request-response-model" title="Permanent link">⚓︎</a></h2>
<p>The Redis server accepts commands composed of different arguments.
Then, the server processes the command and sends the reply back to the client.</p>
<p>This is the simplest model possible; however, there are some exceptions:</p>
<ul>
<li>Redis requests can be <a href="#multiple-commands-and-pipelining">pipelined</a>.
  Pipelining enables clients to send multiple commands at once and wait for replies later.</li>
<li>When a RESP2 connection subscribes to a <a href="/docs/manual/pubsub">Pub/Sub</a> channel, the protocol changes semantics and becomes a <em>push</em> protocol.
  The client no longer requires sending commands because the server will automatically send new messages to the client (for the channels the client is subscribed to) as soon as they are received.</li>
<li>The <code>MONITOR</code> command.
  Invoking the <code>MONITOR</code> command switches the connection to an ad-hoc push mode.
  The protocol of this mode is not specified but is obvious to parse.</li>
<li><a href="/docs/management/security/#protected-mode">Protected mode</a>.
  Connections opened from a non-loopback address to a Redis while in protected mode are denied and terminated by the server.
  Before terminating the connection, Redis unconditionally sends a <code>-DENIED</code> reply, regardless of whether the client writes to the socket.</li>
<li>The <a href="#resp3-pushes">RESP3 Push type</a>.
  As the name suggests, a push type allows the server to send out-of-band data to the connection.
  The server may push data at any time, and the data isn't necessarily related to specific commands executed by the client.</li>
</ul>
<p>Excluding these exceptions, the Redis protocol is a simple request-response protocol.</p>
<h2 id="resp-protocol-description">RESP protocol description<a class="headerlink" href="#resp-protocol-description" title="Permanent link">⚓︎</a></h2>
<p>RESP is essentially a serialization protocol that supports several data types.
In RESP, the first byte of data determines its type.</p>
<p>Redis generally uses RESP as a <a href="#request-response-model">request-response</a> protocol in the following way:</p>
<ul>
<li>Clients send commands to a Redis server as an <a href="#arrays">array</a> of <a href="#bulk-strings">bulk strings</a>.
  The first (and sometimes also the second) bulk string in the array is the command's name.
  Subsequent elements of the array are the arguments for the command.</li>
<li>The server replies with a RESP type.
  The reply's type is determined by the command's implementation and possibly by the client's protocol version.</li>
</ul>
<p>RESP is a binary protocol that uses control sequences encoded in standard ASCII.
The <code>A</code> character, for example, is encoded with the binary byte of value 65.
Similarly, the characters CR (<code>\r</code>), LF (<code>\n</code>) and SP (<code></code>) have binary byte values of 13, 10 and 32, respectively.</p>
<p>The <code>\r\n</code> (CRLF) is the protocol's <em>terminator</em>, which <strong>always</strong> separates its parts.</p>
<p>The first byte in an RESP-serialized payload always identifies its type.
Subsequent bytes constitute the type's contents.</p>
<p>We categorize every RESP data type as either <em>simple</em>, <em>bulk</em> or <em>aggregate</em>.</p>
<p>Simple types are similar to scalars in programming languages that represent plain literal values. Booleans and Integers are such examples.</p>
<p>RESP strings are either <em>simple</em> or <em>bulk</em>.
Simple strings never contain carriage return (<code>\r</code>) or line feed (<code>\n</code>) characters.
Bulk strings can contain any binary data and may also be referred to as <em>binary</em> or <em>blob</em>.
Note that bulk strings may be further encoded and decoded, e.g. with a wide multi-byte encoding, by the client.</p>
<p>Aggregates, such as Arrays and Maps, can have varying numbers of sub-elements and nesting levels.</p>
<p>The following table summarizes the RESP data types that Redis supports:</p>
<table>
<thead>
<tr>
<th>RESP data type</th>
<th>Minimal protocol version</th>
<th>Category</th>
<th>First byte</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#simple-strings">Simple strings</a></td>
<td>RESP2</td>
<td>Simple</td>
<td><code>+</code></td>
</tr>
<tr>
<td><a href="#simple-errors">Simple Errors</a></td>
<td>RESP2</td>
<td>Simple</td>
<td><code>-</code></td>
</tr>
<tr>
<td><a href="#integers">Integers</a></td>
<td>RESP2</td>
<td>Simple</td>
<td><code>:</code></td>
</tr>
<tr>
<td><a href="#bulk-strings">Bulk strings</a></td>
<td>RESP2</td>
<td>Aggregate</td>
<td><code>$</code></td>
</tr>
<tr>
<td><a href="#arrays">Arrays</a></td>
<td>RESP2</td>
<td>Aggregate</td>
<td><code>*</code></td>
</tr>
<tr>
<td><a href="#nulls">Nulls</a></td>
<td>RESP3</td>
<td>Simple</td>
<td><code>_</code></td>
</tr>
<tr>
<td><a href="#booleans">Booleans</a></td>
<td>RESP3</td>
<td>Simple</td>
<td><code>#</code></td>
</tr>
<tr>
<td><a href="#doubles">Doubles</a></td>
<td>RESP3</td>
<td>Simple</td>
<td><code>,</code></td>
</tr>
<tr>
<td><a href="#big-numbers">Big numbers</a></td>
<td>RESP3</td>
<td>Simple</td>
<td><code>(</code></td>
</tr>
<tr>
<td><a href="#bulk-errors">Bulk errors</a></td>
<td>RESP3</td>
<td>Aggregate</td>
<td><code>!</code></td>
</tr>
<tr>
<td><a href="#verbatim-strings">Verbatim strings</a></td>
<td>RESP3</td>
<td>Aggregate</td>
<td><code>=</code></td>
</tr>
<tr>
<td><a href="#maps">Maps</a></td>
<td>RESP3</td>
<td>Aggregate</td>
<td><code>%</code></td>
</tr>
<tr>
<td><a href="#sets">Sets</a></td>
<td>RESP3</td>
<td>Aggregate</td>
<td><code>~</code></td>
</tr>
<tr>
<td><a href="#pushes">Pushes</a></td>
<td>RESP3</td>
<td>Aggregate</td>
<td><code>&gt;</code></td>
</tr>
</tbody>
</table>
<p><a name="simple-string-reply"></a></p>
<h3 id="simple-strings">Simple strings<a class="headerlink" href="#simple-strings" title="Permanent link">⚓︎</a></h3>
<p>Simple strings are encoded as a plus (<code>+</code>) character, followed by a string.
The string mustn't contain a CR (<code>\r</code>) or LF (<code>\n</code>) character and is terminated by CRLF (i.e., <code>\r\n</code>).</p>
<p>Simple strings transmit short, non-binary strings with minimal overhead.
For example, many Redis commands reply with just "OK" on success.
The encoding of this Simple String is the following 5 bytes:</p>
<div class="highlight"><pre><span></span><code>+OK\r\n
</code></pre></div>
<p>When Redis replies with a simple string, a client library should return to the caller a string value composed of the first character after the <code>+</code> up to the end of the string, excluding the final CRLF bytes.</p>
<p>To send binary strings, use <a href="#bulk-strings">bulk strings</a> instead.</p>
<p><a name="error-reply"></a></p>
<h3 id="simple-errors">Simple errors<a class="headerlink" href="#simple-errors" title="Permanent link">⚓︎</a></h3>
<p>RESP has specific data types for errors.
Simple errors, or simply just errors, are similar to <a href="#simple-strings">simple strings</a>, but their first character is the minus (<code>-</code>) character.
The difference between simple strings and errors in RESP is that clients should treat errors as exceptions, whereas the string encoded in the error type is the error message itself.</p>
<p>The basic format is:</p>
<div class="highlight"><pre><span></span><code>-Error message\r\n
</code></pre></div>
<p>Redis replies with an error only when something goes wrong, for example, when you try to operate against the wrong data type, or when the command does not exist.
The client should raise an exception when it receives an Error reply.</p>
<p>The following are examples of error replies:</p>
<div class="highlight"><pre><span></span><code>-ERR unknown command &#39;asdf&#39;
-WRONGTYPE Operation against a key holding the wrong kind of value
</code></pre></div>
<p>The first upper-case word after the <code>-</code>, up to the first space or newline, represents the kind of error returned.
This word is called an <em>error prefix</em>.
Note that the error prefix is a convention used by Redis rather than part of the RESP error type.</p>
<p>For example, in Redis, <code>ERR</code> is a generic error, whereas <code>WRONGTYPE</code> is a more specific error that implies that the client attempted an operation against the wrong data type.
The error prefix allows the client to understand the type of error returned by the server without checking the exact error message.</p>
<p>A client implementation can return different types of exceptions for various errors, or provide a generic way for trapping errors by directly providing the error name to the caller as a string.</p>
<p>However, such a feature should not be considered vital as it is rarely useful. 
Also, simpler client implementations can return a generic error value, such as <code>false</code>.</p>
<p><a name="integer-reply"></a></p>
<h3 id="integers">Integers<a class="headerlink" href="#integers" title="Permanent link">⚓︎</a></h3>
<p>This type is a CRLF-terminated string that represents a signed, base-10, 64-bit integer.</p>
<p>RESP encodes integers in the following way:</p>
<div class="highlight"><pre><span></span><code>:[&lt;+|-&gt;]&lt;value&gt;\r\n
</code></pre></div>
<ul>
<li>The colon (<code>:</code>) as the first byte.</li>
<li>An optional plus (<code>+</code>) or minus (<code>-</code>) as the sign.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as the integer's unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
</ul>
<p>For example, <code>:0\r\n</code> and <code>:1000\r\n</code> are integer replies (of zero and one thousand, respectively).</p>
<p>Many Redis commands return RESP integers, including <code>INCR</code>, <code>LLEN</code>, and <code>LASTSAVE</code>.
An integer, by itself, has no special meaning other than in the context of the command that returned it.
For example, it is an incremental number for <code>INCR</code>, a UNIX timestamp for <code>LASTSAVE</code>, and so forth.
However, the returned integer is guaranteed to be in the range of a signed 64-bit integer.</p>
<p>In some cases, integers can represent true and false Boolean values.
For instance, <code>SISMEMBER</code> returns 1 for true and 0 for false.</p>
<p>Other commands, including <code>SADD</code>, <code>SREM</code>, and <code>SETNX</code>, return 1 when the data changes and 0 otherwise.</p>
<p><a name="bulk-string-reply"></a></p>
<h3 id="bulk-strings">Bulk strings<a class="headerlink" href="#bulk-strings" title="Permanent link">⚓︎</a></h3>
<p>A bulk string represents a single binary string.
The string can be of any size, but by default, Redis limits it to 512 MB (see the <code>proto-max-bulk-len</code> configuration directive).</p>
<p>RESP encodes bulk strings in the following way:</p>
<div class="highlight"><pre><span></span><code>$&lt;length&gt;\r\n&lt;data&gt;\r\n
</code></pre></div>
<ul>
<li>The dollar sign (<code>$</code>) as the first byte.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as the string's length, in bytes, as an unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
<li>The data.</li>
<li>A final CRLF.</li>
</ul>
<p>So the string "hello" is encoded as follows:</p>
<div class="highlight"><pre><span></span><code>$5\r\nhello\r\n
</code></pre></div>
<p>The empty string's encoding is:</p>
<div class="highlight"><pre><span></span><code>$0\r\n\r\n
</code></pre></div>
<p><a name="nil-reply"></a></p>
<h4 id="null-bulk-strings">Null bulk strings<a class="headerlink" href="#null-bulk-strings" title="Permanent link">⚓︎</a></h4>
<p>Whereas RESP3 has a dedicated data type for <a href="#nulls">null values</a>, RESP2 has no such type.
Instead, due to historical reasons, the representation of null values in RESP2 is via predetermined forms of the <a href="#bulk-strings">bulk strings</a> and <a href="#arrays">arrays</a> types.</p>
<p>The null bulk string represents a non-existing value.
The <code>GET</code> command returns the Null Bulk String when the target key doesn't exist.</p>
<p>It is encoded as a bulk string with the length of negative one (-1), like so:</p>
<div class="highlight"><pre><span></span><code>$-1\r\n
</code></pre></div>
<p>A Redis client should return a nil object when the server replies with a null bulk string rather than the empty string.
For example, a Ruby library should return <code>nil</code> while a C library should return <code>NULL</code> (or set a special flag in the reply object).</p>
<p><a name="array-reply"></a></p>
<h3 id="arrays">Arrays<a class="headerlink" href="#arrays" title="Permanent link">⚓︎</a></h3>
<p>Clients send commands to the Redis server as RESP arrays.
Similarly, some Redis commands that return collections of elements use arrays as their replies. 
An example is the <code>LRANGE</code> command that returns elements of a list.</p>
<p>RESP Arrays' encoding uses the following format:</p>
<div class="highlight"><pre><span></span><code>*&lt;number-of-elements&gt;\r\n&lt;element-1&gt;...&lt;element-n&gt;
</code></pre></div>
<ul>
<li>An asterisk (<code>*</code>) as the first byte.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as the number of elements in the array as an unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
<li>An additional RESP type for every element of the array.</li>
</ul>
<p>So an empty Array is just the following:</p>
<div class="highlight"><pre><span></span><code>*0\r\n
</code></pre></div>
<p>Whereas the encoding of an array consisting of the two bulk strings "hello" and "world" is:</p>
<div class="highlight"><pre><span></span><code>*2\r\n$5\r\nhello\r\n$5\r\nworld\r\n
</code></pre></div>
<p>As you can see, after the <code>*&lt;count&gt;CRLF</code> part prefixing the array, the other data types that compose the array are concatenated one after the other.
For example, an Array of three integers is encoded as follows:</p>
<div class="highlight"><pre><span></span><code>*3\r\n:1\r\n:2\r\n:3\r\n
</code></pre></div>
<p>Arrays can contain mixed data types.
For instance, the following encoding is of a list of four integers and a bulk string:</p>
<div class="highlight"><pre><span></span><code>*5\r\n
:1\r\n
:2\r\n
:3\r\n
:4\r\n
$5\r\n
hello\r\n
</code></pre></div>
<p>(The raw RESP encoding is split into multiple lines for readability).</p>
<p>The first line the server sent is <code>*5\r\n</code>.
This numeric value tells the client that five reply types are about to follow it.
Then, every successive reply constitutes an element in the array.</p>
<p>All of the aggregate RESP types support nesting.
For example, a nested array of two arrays is encoded as follows:</p>
<div class="highlight"><pre><span></span><code>*2\r\n
*3\r\n
:1\r\n
:2\r\n
:3\r\n
*2\r\n
+Hello\r\n
-World\r\n
</code></pre></div>
<p>(The raw RESP encoding is split into multiple lines for readability).</p>
<p>The above encodes a two-element array.
The first element is an array that, in turn, contains three integers (1, 2, 3).
The second element is another array containing a simple string and an error.</p>
<p>{{% alert title="Multi bulk reply" color="info" %}}
In some places, the RESP Array type may be referred to as <em>multi bulk</em>.
The two are the same.
{{% /alert %}}</p>
<p><a name="nil-array-reply"></a></p>
<h4 id="null-arrays">Null arrays<a class="headerlink" href="#null-arrays" title="Permanent link">⚓︎</a></h4>
<p>Whereas RESP3 has a dedicated data type for <a href="#nulls">null values</a>, RESP2 has no such type. Instead, due to historical reasons, the representation of null values in RESP2 is via predetermined forms of the <a href="#bulk-strings">Bulk Strings</a> and <a href="#arrays">arrays</a> types.</p>
<p>Null arrays exist as an alternative way of representing a null value.
For instance, when the <code>BLPOP</code> command times out, it returns a null array.</p>
<p>The encoding of a null array is that of an array with the length of -1, i.e.:</p>
<div class="highlight"><pre><span></span><code>*-1\r\n
</code></pre></div>
<p>When Redis replies with a null array, the client should return a null object rather than an empty array.
This is necessary to distinguish between an empty list and a different condition (for instance, the timeout condition of the <code>BLPOP</code> command).</p>
<h4 id="null-elements-in-arrays">Null elements in arrays<a class="headerlink" href="#null-elements-in-arrays" title="Permanent link">⚓︎</a></h4>
<p>Single elements of an array may be <a href="#null-bulk-strings">null bulk string</a>.
This is used in Redis replies to signal that these elements are missing and not empty strings. This can happen, for example, with the <code>SORT</code> command when used with the <code>GET pattern</code> option
if the specified key is missing.</p>
<p>Here's an example of an array reply containing a null element:</p>
<div class="highlight"><pre><span></span><code>*3\r\n
$5\r\n
hello\r\n
$-1\r\n
$5\r\n
world\r\n
</code></pre></div>
<p>Above, the second element is null.
The client library should return to its caller something like this:</p>
<div class="highlight"><pre><span></span><code>[&quot;hello&quot;,nil,&quot;world&quot;]
</code></pre></div>
<p><a name="null-reply"></a></p>
<h3 id="nulls">Nulls<a class="headerlink" href="#nulls" title="Permanent link">⚓︎</a></h3>
<p>The null data type represents non-existent values.</p>
<p>Nulls' encoding is the underscore (<code>_</code>) character, followed by the CRLF terminator (<code>\r\n</code>).
Here's Null's raw RESP encoding:</p>
<div class="highlight"><pre><span></span><code>_\r\n
</code></pre></div>
<p>{{% alert title="Null Bulk String, Null Arrays and Nulls" color="info" %}}
Due to historical reasons, RESP2 features two specially crafted values for representing null values of bulk strings and arrays.
This duality has always been a redundancy that added zero semantical value to the protocol itself.</p>
<p>The null type, introduced in RESP3, aims to fix this wrong.
{{% /alert %}}</p>
<p><a name="boolean-reply"></p>
<h3 id="booleans">Booleans<a class="headerlink" href="#booleans" title="Permanent link">⚓︎</a></h3>
<p>RESP booleans are encoded as follows:</p>
<div class="highlight"><pre><span></span><code>#&lt;t|f&gt;\r\n
</code></pre></div>
<ul>
<li>The octothorpe character (<code>#</code>) as the first byte.</li>
<li>A <code>t</code> character for true values, or an <code>f</code> character for false ones.</li>
<li>The CRLF terminator.</li>
</ul>
<p><a name="double-reply"></a></p>
<h3 id="doubles">Doubles<a class="headerlink" href="#doubles" title="Permanent link">⚓︎</a></h3>
<p>The Double RESP type encodes a double-precision floating point value.
Doubles are encoded as follows:</p>
<div class="highlight"><pre><span></span><code>,[&lt;+|-&gt;]&lt;integral&gt;[.&lt;fractional&gt;][&lt;E|e&gt;[sign]&lt;exponent&gt;]\r\n
</code></pre></div>
<ul>
<li>The comma character (<code>,</code>) as the first byte.</li>
<li>An optional plus (<code>+</code>) or minus (<code>-</code>) as the sign.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as an unsigned, base-10 integral value.</li>
<li>An optional dot (<code>.</code>), followed by one or more decimal digits (<code>0</code>..<code>9</code>) as an unsigned, base-10 fractional value.</li>
<li>An optional capital or lowercase letter E (<code>E</code> or <code>e</code>), followed by an optional plus (<code>+</code>) or minus (<code>-</code>) as the exponent's sign, ending with one or more decimal digits (<code>0</code>..<code>9</code>) as an unsigned, base-10 exponent value.</li>
<li>The CRLF terminator.</li>
</ul>
<p>Here's the encoding of the number 1.23:</p>
<div class="highlight"><pre><span></span><code>,1.23\r\n
</code></pre></div>
<p>Because the fractional part is optional, the integer value of ten (10) can, therefore, be RESP-encoded both as an integer as well as a double:</p>
<div class="highlight"><pre><span></span><code>:10\r\n
,10\r\n
</code></pre></div>
<p>In such cases, the Redis client should return native integer and double values, respectively, providing that these types are supported by the language of its implementation.</p>
<p>The positive infinity, negative infinity and NaN values are encoded as follows:</p>
<div class="highlight"><pre><span></span><code>,inf\r\n
,-inf\r\n
,nan\r\n
</code></pre></div>
<p><a name="big-number-reply"></a></p>
<h3 id="big-numbers">Big numbers<a class="headerlink" href="#big-numbers" title="Permanent link">⚓︎</a></h3>
<p>This type can encode integer values outside the range of signed 64-bit integers.</p>
<p>Big numbers use the following encoding:</p>
<div class="highlight"><pre><span></span><code>([+|-]&lt;number&gt;\r\n
</code></pre></div>
<ul>
<li>The left parenthesis character (<code>(</code>) as the first byte.</li>
<li>An optional plus (<code>+</code>) or minus (<code>-</code>) as the sign.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as an unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>(3492890328409238509324850943850943825024385\r\n
</code></pre></div>
<p>Big numbers can be positive or negative but can't include fractionals.
Client libraries written in languages with a big number type should return a big number.
When big numbers aren't supported, the client should return a string and, when possible, signal to the caller that the reply is a big integer (depending on the API used by the client library).</p>
<p><a name="bulk-error-reply"></a></p>
<h3 id="bulk-errors">Bulk errors<a class="headerlink" href="#bulk-errors" title="Permanent link">⚓︎</a></h3>
<p>This type combines the purpose of <a href="#simple-errors">simple errors</a> with the expressive power of <a href="#bulk-strings">bulk strings</a>.</p>
<p>It is encoded as:</p>
<div class="highlight"><pre><span></span><code>!&lt;length&gt;\r\n&lt;error&gt;\r\n
</code></pre></div>
<ul>
<li>An exclamation mark (<code>!</code>) as the first byte.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as the error's length, in bytes, as an unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
<li>The error itself.</li>
<li>A final CRLF.</li>
</ul>
<p>As a convention, the error begins with an uppercase (space-delimited) word that conveys the error message.</p>
<p>For instance, the error "SYNTAX invalid syntax" is represented by the following protocol encoding:</p>
<div class="highlight"><pre><span></span><code>!21\r\n
SYNTAX invalid syntax\r\n
</code></pre></div>
<p>(The raw RESP encoding is split into multiple lines for readability).</p>
<p><a name="verbatim-string-reply"></p>
<h3 id="verbatim-strings">Verbatim strings<a class="headerlink" href="#verbatim-strings" title="Permanent link">⚓︎</a></h3>
<p>This type is similar to the <a href="#bulk-strings">bulk string</a>, with the addition of providing a hint about the data's encoding.</p>
<p>A verbatim string's RESP encoding is as follows:</p>
<div class="highlight"><pre><span></span><code>=&lt;length&gt;\r\n&lt;encoding&gt;:&lt;data&gt;\r\n
</code></pre></div>
<ul>
<li>An equal sign (<code>=</code>) as the first byte.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as the string's total length, in bytes, as an unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
<li>Exactly three (3) bytes represent the data's encoding.</li>
<li>The colon (<code>:</code>) character separates the encoding and data.</li>
<li>The data.</li>
<li>A final CRLF.</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><code>=15\r\n
txt:Some string\r\n
</code></pre></div>
<p>(The raw RESP encoding is split into multiple lines for readability).</p>
<p>Some client libraries may ignore the difference between this type and the string type and return a native string in both cases.
However, interactive clients, such as command line interfaces (e.g., <a href="/docs/manual/cli"><code>redis-cli</code></a>), can use this type and know that their output should be presented to the human user as is and without quoting the string.</p>
<p>For example, the Redis command <code>INFO</code> outputs a report that includes newlines.
When using RESP3, <code>redis-cli</code> displays it correctly because it is sent as a Verbatim String reply (with its three bytes being "txt").
When using RESP2, however, the <code>redis-cli</code> is hard-coded to look for the <code>INFO</code> command to ensure its correct display to the user.</p>
<p><a name="map-reply"></a></p>
<h3 id="maps">Maps<a class="headerlink" href="#maps" title="Permanent link">⚓︎</a></h3>
<p>The RESP map encodes a collection of key-value tuples, i.e., a dictionary or a hash.</p>
<p>It is encoded as follows:</p>
<div class="highlight"><pre><span></span><code>%&lt;number-of-entries&gt;\r\n&lt;key-1&gt;&lt;value-1&gt;...&lt;key-n&gt;&lt;value-n&gt;
</code></pre></div>
<ul>
<li>A percent character (<code>%</code>) as the first byte.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as the number of entries, or key-value tuples, in the map as an unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
<li>Two additional RESP types for every key and value in the map.</li>
</ul>
<p>For example, the following JSON object:</p>
<div class="highlight"><pre><span></span><code>{
    &quot;first&quot;: 1,
    &quot;second&quot;: 2
}
</code></pre></div>
<p>Can be encoded in RESP like so:</p>
<div class="highlight"><pre><span></span><code>%2\r\n
+first\r\n
:1\r\n
+second\r\n
:2\r\n
</code></pre></div>
<p>(The raw RESP encoding is split into multiple lines for readability).</p>
<p>Both map keys and values can be any of RESP's types.</p>
<p>Redis clients should return the idiomatic dictionary type that their language provides.
However, low-level programming languages (such as C, for example) will likely return an array along with type information that indicates to the caller that it is a dictionary.</p>
<p>{{% alert title="Map pattern in RESP2" color="info" %}}
RESP2 doesn't have a map type.
A map in RESP2 is represented by a flat array containing the keys and the values.
The first element is a key, followed by the corresponding value, then the next key and so on, like this:
<code>key1, value1, key2, value2, ...</code>.
{{% /alert %}}</p>
<p><a name="set-reply"></a></p>
<h3 id="sets">Sets<a class="headerlink" href="#sets" title="Permanent link">⚓︎</a></h3>
<p>Sets are somewhat like <a href="#arrays">Arrays</a> but are unordered and should only contain unique elements.</p>
<p>RESP set's encoding is:</p>
<div class="highlight"><pre><span></span><code>~&lt;number-of-elements&gt;\r\n&lt;element-1&gt;...&lt;element-n&gt;
</code></pre></div>
<ul>
<li>A tilde (<code>~</code>) as the first byte.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as the number of elements in the set as an unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
<li>An additional RESP type for every element of the Set.</li>
</ul>
<p>Clients should return the native set type if it is available in their programming language.
Alternatively, in the absence of a native set type, an array coupled with type information can be used (in C, for example).</p>
<p><a name="push-event"></a></p>
<h3 id="pushes">Pushes<a class="headerlink" href="#pushes" title="Permanent link">⚓︎</a></h3>
<p>RESP's pushes contain out-of-band data.
They are an exception to the protocol's request-response model and provide a generic <em>push mode</em> for connections.</p>
<p>Push events are encoded similarly to <a href="#arrays">arrays</a>, differing only in their first byte:</p>
<div class="highlight"><pre><span></span><code>&gt;&lt;number-of-elements&gt;\r\n&lt;element-1&gt;...&lt;element-n&gt;
</code></pre></div>
<ul>
<li>A greater-than sign (<code>&gt;</code>) as the first byte.</li>
<li>One or more decimal digits (<code>0</code>..<code>9</code>) as the number of elements in the message as an unsigned, base-10 value.</li>
<li>The CRLF terminator.</li>
<li>An additional RESP type for every element of the push event.</li>
</ul>
<p>Pushed data may precede or follow any of RESP's data types but never inside them.
That means a client won't find push data in the middle of a map reply, for example.
It also means that pushed data may appear before or after a command's reply, as well as by itself (without calling any command).</p>
<p>Clients should react to pushes by invoking a callback that implements their handling of the pushed data.</p>
<h2 id="client-handshake">Client handshake<a class="headerlink" href="#client-handshake" title="Permanent link">⚓︎</a></h2>
<p>New RESP connections should begin the session by calling the <code>HELLO</code> command.
This practice accomplishes two things:</p>
<ol>
<li>It allows servers to be backward compatible with RESP2 versions.
  This is needed in Redis to make the transition to version 3 of the protocol gentler.</li>
<li>The <code>HELLO</code> command returns information about the server and the protocol that the client can use for different goals.</li>
</ol>
<p>The <code>HELLO</code> command has the following high-level syntax:</p>
<div class="highlight"><pre><span></span><code>HELLO &lt;protocol-version&gt; [optional-arguments]
</code></pre></div>
<p>The first argument of the command is the protocol version we want the connection to be set.
By default, the connection starts in RESP2 mode.
If we specify a connection version that is too big and unsupported by the server, it should reply with a <code>-NOPROTO</code> error. Example:</p>
<div class="highlight"><pre><span></span><code>Client: HELLO 4
Server: -NOPROTO sorry, this protocol version is not supported.
</code></pre></div>
<p>At that point, the client may retry with a lower protocol version.</p>
<p>Similarly, the client can easily detect a server that is only able to speak RESP2:</p>
<div class="highlight"><pre><span></span><code>Client: HELLO 3
Server: -ERR unknown command &#39;HELLO&#39;
</code></pre></div>
<p>The client can then proceed and use RESP2 to communicate with the server.</p>
<p>Note that even if the protocol's version is supported, the <code>HELLO</code> command may return an error, perform no action and remain in RESP2 mode. 
For example, when used with invalid authentication credentials in the command's optional <code>!AUTH</code> clause:</p>
<div class="highlight"><pre><span></span><code>Client: HELLO 3 AUTH default mypassword
Server: -ERR invalid password
(the connection remains in RESP2 mode)
</code></pre></div>
<p>A successful reply to the <code>HELLO</code> command is a map reply.
The information in the reply is partly server-dependent, but certain fields are mandatory for all the RESP3 implementations:
* <strong>server</strong>: "redis" (or other software name).
* <strong>version</strong>: the server's version.
* <strong>proto</strong>: the highest supported version of the RESP protocol.</p>
<p>In Redis' RESP3 implementation, the following fields are also emitted:</p>
<ul>
<li><strong>id</strong>: the connection's identifier (ID).</li>
<li><strong>mode</strong>: "standalone", "sentinel" or "cluster".</li>
<li><strong>role</strong>: "master" or "replica".</li>
<li><strong>modules</strong>: list of loaded modules as an Array of Bulk Strings.</li>
</ul>
<h2 id="sending-commands-to-a-redis-server">Sending commands to a Redis server<a class="headerlink" href="#sending-commands-to-a-redis-server" title="Permanent link">⚓︎</a></h2>
<p>Now that you are familiar with the RESP serialization format, you can use it to help write a Redis client library.
We can further specify how the interaction between the client and the server works:</p>
<ul>
<li>A client sends the Redis server an <a href="#arrays">array</a> consisting of only bulk strings.</li>
<li>A Redis server replies to clients, sending any valid RESP data type as a reply.</li>
</ul>
<p>So, for example, a typical interaction could be the following.</p>
<p>The client sends the command <code>LLEN mylist</code> to get the length of the list stored at the key <em>mylist</em>.
Then the server replies with an <a href="#integers">integer</a> reply as in the following example (<code>C:</code> is the client, <code>S:</code> the server).</p>
<div class="highlight"><pre><span></span><code>C: *2\r\n
C: $4\r\n
C: LLEN\r\n
C: $6\r\n
C: mylist\r\n

S: :48293\r\n
</code></pre></div>
<p>As usual, we separate different parts of the protocol with newlines for simplicity, but the actual interaction is the client sending <code>*2\r\n$4\r\nLLEN\r\n$6\r\nmylist\r\n</code> as a whole.</p>
<h2 id="multiple-commands-and-pipelining">Multiple commands and pipelining<a class="headerlink" href="#multiple-commands-and-pipelining" title="Permanent link">⚓︎</a></h2>
<p>A client can use the same connection to issue multiple commands.
Pipelining is supported, so multiple commands can be sent with a single write operation by the client.
The client can skip reading replies and continue to send the commands one after the other.
All the replies can be read at the end.</p>
<p>For more information, see <a href="/topics/pipelining">Pipelining</a>.</p>
<h2 id="inline-commands">Inline commands<a class="headerlink" href="#inline-commands" title="Permanent link">⚓︎</a></h2>
<p>Sometimes you may need to send a command to the Redis server but only have <code>telnet</code> available.
While the Redis protocol is simple to implement, it is not ideal for interactive sessions, and <code>redis-cli</code> may not always be available.
For this reason, Redis also accepts commands in the <em>inline command</em> format.</p>
<p>The following example demonstrates a server/client exchange using an inline command (the server chat starts with <code>S:</code>, the client chat with <code>C:</code>):</p>
<div class="highlight"><pre><span></span><code>C: PING
S: +PONG
</code></pre></div>
<p>Here's another example of an inline command where the server returns an integer:</p>
<div class="highlight"><pre><span></span><code>C: EXISTS somekey
S: :0
</code></pre></div>
<p>Basically, to issue an inline command, you write space-separated arguments in a telnet session.
Since no command starts with <code>*</code> (the identifying byte of RESP Arrays), Redis detects this condition and parses your command inline.</p>
<h2 id="high-performance-parser-for-the-redis-protocol">High-performance parser for the Redis protocol<a class="headerlink" href="#high-performance-parser-for-the-redis-protocol" title="Permanent link">⚓︎</a></h2>
<p>While the Redis protocol is human-readable and easy to implement, its implementation can exhibit performance similar to that of a binary protocol.</p>
<p>RESP uses prefixed lengths to transfer bulk data.
That makes scanning the payload for special characters unnecessary (unlike parsing JSON, for example).
For the same reason, quoting and escaping the payload isn't needed.</p>
<p>Reading the length of aggregate types (for example, bulk strings or arrays) can be processed with code that performs a single operation per character while at the same time scanning for the CR character.</p>
<p>Example (in C):</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$123</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="n">p</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="sc">&#39;\r&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">len</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="sc">&#39;0&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="n">p</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/* Now p points at &#39;\r&#39;, and the len is in bulk_len. */</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">len</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>After the first CR is identified, it can be skipped along with the following LF without further processing.
Then, the bulk data can be read with a single read operation that doesn't inspect the payload in any way.
Finally, the remaining CR and LF characters are discarded without additional processing.</p>
<p>While comparable in performance to a binary protocol, the Redis protocol is significantly more straightforward to implement in most high-level languages, reducing the number of bugs in client software.</p>
<h2 id="tips-for-redis-client-authors">Tips for Redis client authors<a class="headerlink" href="#tips-for-redis-client-authors" title="Permanent link">⚓︎</a></h2>
<ul>
<li>For testing purposes, use <a href="/topics/lua-api#lua-to-resp3-type-conversion">Lua's type conversions</a> to have Redis reply with any RESP2/RESP3 needed.
  As an example, a RESP3 double can be generated like so:
  <div class="highlight"><pre><span></span><code>EVAL &quot;return { double = tonumber(ARGV[1]) }&quot; 0 1e0
</code></pre></div></li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 25, 2023</span>
      
        <br>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 25, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../key-specs/" class="md-footer__link md-footer__link--prev" aria-label="上一页: Command key specifications">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                Command key specifications
              </div>
            </div>
          </a>
        
        
          
          <a href="../sentinel-clients/" class="md-footer__link md-footer__link--next" aria-label="下一页: Sentinel client spec">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                Sentinel client spec
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Ean Yang
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/YQisme" target="_blank" rel="noopener" title="github主页" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://space.bilibili.com/244185393?spm_id_from=333.788.0.0" target="_blank" rel="noopener" title="b站主页" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0s16.1 2.868 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0c8.8 0 16.1 2.868 21.9 8.603 5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1zm-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8 6.3-6.5 9.7-14.3 10.1-23.5V173.8zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5-9.6 0-17.5-3.2-23.6-9.5-6.1-6.3-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2 6.3-6.3 13.2-9.6 23.3-10 9.2.4 17 3.7 23.3 10zm191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.1 6.3-14 9.5-23.6 9.5-9.6 0-17.4-3.2-23.6-9.5-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2 6.3-6.3 14.1-9.6 23.3-10 9.2.4 17 3.7 23.3 10z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://eanyang7.com" target="_blank" rel="noopener" title="个人主页" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M112 48a48 48 0 1 1 96 0 48 48 0 1 1-96 0zm40 304v128c0 17.7-14.3 32-32 32s-32-14.3-32-32V256.9l-28.6 47.6c-9.1 15.1-28.8 20-43.9 10.9s-20-28.8-10.9-43.9l58.3-97c17.4-28.9 48.6-46.6 82.3-46.6h29.7c33.7 0 64.9 17.7 82.3 46.6l58.3 97c9.1 15.1 4.2 34.8-10.9 43.9s-34.8 4.2-43.9-10.9L232 256.9V480c0 17.7-14.3 32-32 32s-32-14.3-32-32V352h-16z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.prune", "navigation.top", "toc.follow", "header.autohide", "navigation.footer", "search.suggest", "search.highlight", "search.share", "content.action.edit", "content.action.view", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c14ae12.min.js"></script>
      
    
  </body>
</html>